<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LunarSMP - Minecraft Server</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
/* ... toàn bộ CSS bạn dán ở trên ... */
</style>
</head>
<body>

<header><h1>LunarisSMP</h1></header>

<div class="container">
  <div class="server-card">
    <h2>LunarisSMP</h2>
    <p>IP Server: <strong>mbasic7.pikamc.vn:25219</strong></p>
    <p>Trạng thái server: <span id="server-status">Đang kiểm tra...</span></p>
    <p>Người chơi online: <span id="players-online">Đang tải...</span></p>
    <div class="player-list" id="player-list"></div>
    <a href="minecraft://mbasic7.pikamc.vn:25219" class="btn-join">Tham gia Server</a>
  </div>
</div>

<div class="news">
  <h3>Tin tức & Sự kiện</h3>
  <div id="newsList"></div>
</div>

<footer>&copy; 2025 LunarSMP. All rights reserved.</footer>

<script>
async function checkServerStatus(){
  try{
    const res=await fetch('https://api.mcsrvstat.us/2/mbasic7.pikamc.vn:25219');
    const data=await res.json();
    const status=document.getElementById('server-status');
    const players=document.getElementById('players-online');
    const playerList=document.getElementById('player-list');
    playerList.innerHTML='';
    if(data.online){
      status.textContent='Online'; status.className='status-online';
      const onlineCount=data.players?.online||0;
      players.textContent=onlineCount+' người';
      if(data.players?.list){
        data.players.list.forEach(name=>{
          const img=document.createElement('img');
          img.src=`https://minotar.net/avatar/${name}/40.png`;
          img.className='player';
          playerList.appendChild(img);
        });
      }
    }else{
      status.textContent='Offline'; status.className='status-offline';
      players.textContent='0 người';
    }
  }catch(e){
    document.getElementById('server-status').textContent='Không thể kết nối';
    document.getElementById('server-status').className='status-offline';
    document.getElementById('players-online').textContent='0 người';
  }
}
checkServerStatus(); setInterval(checkServerStatus,60000);

async function loadNews(){
  const newsList=document.getElementById('newsList');
  try{
    const res=await fetch('/api/news');
    const news=await res.json();
    if(news.length===0){ newsList.innerHTML='<p>Chưa có tin tức</p>'; }
    else{ newsList.innerHTML=news.map((n,i)=>`<p>[${i+1}] ${n}</p>`).join(''); }
  }catch(e){
    newsList.innerHTML='<p>Lỗi tải tin tức</p>';
  }
}
loadNews();
</script>

</body>
</html>
